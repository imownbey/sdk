type: 'library'
language: 'typescript'

project:
  name: 'code-storage-typescript'
  description: 'Pierre Git Storage SDK for TypeScript'

fileGroups:
  sourceInputs:
    - 'src/**/*'
  configInputs:
    - 'tsup.config.ts'
    - 'tsconfig.json'
    - 'tsconfig.*.json'
  outputs:
    - 'dist/**/*'

tasks:
  test:
    command:
      - 'pnpm'
      - 'vitest'
      - 'run'
    inputs:
      - '@globs(configInputs)'
      - '@globs(sourceInputs)'
      - 'tests/**/*'
      - 'vitest.config.ts'
    options:
      runInCI: true
      cache: true

  build:
    command:
      - 'tsup'
    inputs:
      - '@globs(configInputs)'
      - '@globs(sourceInputs)'
    outputs:
      - '@globs(outputs)'
    options:
      runInCI: true
      cache: true
      mergeArgs: replace
      mergeInputs: replace
      mergeOutputs: replace

  dev:
    command:
      - 'tsup'
      - '--watch'
    inputs:
      - '@globs(configInputs)'
      - '@globs(sourceInputs)'
    options:
      cache: false
      persistent: true
      runInCI: false
